THREE.ObjectControls=function(t,n,o,e){this.setObjectToMove=function(t){a=t},this.autoSpeed=.1,this.rotationSpeed=.07,this.mouseBusy=!1,this.setRotationSpeed=function(t){this.rotationSpeed=t},this.setRotationSpeedTouchDevices=function(t){s=t},this.enableVerticalRotation=function(){r=!0},this.disableVerticalRotation=function(){r=!1},this.enableHorizontalRotation=function(){h=!0},this.disableHorizontalRotation=function(){h=!1},this.setMaxVerticalRotationAngle=function(t,n){this.maxRotationAngles.x.from=t,this.maxRotationAngles.x.to=n,this.maxRotationAngles.x.enabled=!0},this.setMaxHorizontalRotationAngle=function(t,n){this.maxRotationAngles.y.from=t,this.maxRotationAngles.y.to=n,this.maxRotationAngles.y.enabled=!0},this.disableMaxHorizontalAngleRotation=function(){this.maxRotationAngles.y.enabled=!1},this.disableMaxVerticalAngleRotation=function(){this.maxRotationAngles.x.enabled=!1},this.update=function(t){u||(a.rotation.y+=this.autoSpeed*t)},n=void 0!==n?n:document,this.maxRotationAngles={x:{enabled:!0,from:.92,to:.74},y:{enabled:!1,from:Math.PI/4,to:Math.PI/4}};let i,a=t,s=.05,u=!1,r=!0,h=!0,f=0,l=1,c={x:0,y:0},d=[],x=this;function g(t,n){if(x.maxRotationAngles[n].enabled){return!!(-1*x.maxRotationAngles[n].from<a.rotation[n]+t&&a.rotation[n]+t<x.maxRotationAngles[n].to)}return!0}function y(){c={x:0,y:0}}function m(){u=!1,y(),n.style.cursor="grab"}!o&&e||(n.addEventListener("mousedown",(function(t){x.mouseBusy||(u=!0,i=f,n.style.cursor="grabbing")}),!1),n.addEventListener("mousemove",(function(t){if(u){const n={x:t.offsetX-c.x,y:t.offsetY-c.y};if(c={x:t.offsetX,y:t.offsetY},h&&0!=n.x){if(!g(Math.sign(n.x)*x.rotationSpeed,"y"))return;a.rotation.y+=Math.sign(n.x)*x.rotationSpeed,i=l}if(r&&0!=n.y){if(!g(Math.sign(n.y)*x.rotationSpeed,"x"))return;a.rotation.x+=Math.sign(n.y)*x.rotationSpeed,i=l}}}),!1),n.addEventListener("mouseup",m,!1),n.addEventListener("mouseout",m,!1),n.addEventListener("touchstart",(function(t){t.preventDefault(),i=f,2===t.touches.length||(c={x:t.touches[0].pageX,y:t.touches[0].pageY})}),!1),n.addEventListener("touchmove",(function(t){if(t.preventDefault(),i=l,0===d.length){const n={x:t.touches[0].pageX-c.x,y:t.touches[0].pageY-c.y};if(c={x:t.touches[0].pageX,y:t.touches[0].pageY},h&&0!=n.x){if(!g(Math.sign(n.x)*s,"y"))return;a.rotation.y+=Math.sign(n.x)*s}if(r&&0!=n.y){if(!g(Math.sign(n.y)*s,"x"))return;a.rotation.x+=Math.sign(n.y)*s}}}),!1),n.addEventListener("touchend",(function(t){d.length>0?d.pop():d=[],t.preventDefault(),y()}),!1))};