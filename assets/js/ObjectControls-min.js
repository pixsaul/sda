THREE.ObjectControls=function(t,n,o){this.setObjectToMove=function(t){i=t},this.autoSpeed=.1,this.rotationSpeed=.07,this.mouseBusy=!1,this.setRotationSpeed=function(t){this.rotationSpeed=t},this.setRotationSpeedTouchDevices=function(t){a=t},this.enableVerticalRotation=function(){u=!0},this.disableVerticalRotation=function(){u=!1},this.enableHorizontalRotation=function(){r=!0},this.disableHorizontalRotation=function(){r=!1},this.setMaxVerticalRotationAngle=function(t,n){this.maxRotationAngles.x.from=t,this.maxRotationAngles.x.to=n,this.maxRotationAngles.x.enabled=!0},this.setMaxHorizontalRotationAngle=function(t,n){this.maxRotationAngles.y.from=t,this.maxRotationAngles.y.to=n,this.maxRotationAngles.y.enabled=!0},this.disableMaxHorizontalAngleRotation=function(){this.maxRotationAngles.y.enabled=!1},this.disableMaxVerticalAngleRotation=function(){this.maxRotationAngles.x.enabled=!1},this.update=function(t){s||(i.rotation.y+=this.autoSpeed*t)},n=void 0!==n?n:document,this.maxRotationAngles={x:{enabled:!0,from:.92,to:.74},y:{enabled:!1,from:Math.PI/4,to:Math.PI/4}};let e,i=t,a=.05,s=!1,u=!0,r=!0,h=0,f=1,l={x:0,y:0},c=[],d=this;function x(t,n){if(d.maxRotationAngles[n].enabled){return!!(-1*d.maxRotationAngles[n].from<i.rotation[n]+t&&i.rotation[n]+t<d.maxRotationAngles[n].to)}return!0}function g(){l={x:0,y:0}}function y(){s=!1,g(),n.style.cursor="grab"}o&&(n.addEventListener("mousedown",(function(t){d.mouseBusy||(s=!0,e=h,n.style.cursor="grabbing")}),!1),n.addEventListener("mousemove",(function(t){if(s){const n={x:t.offsetX-l.x,y:t.offsetY-l.y};if(l={x:t.offsetX,y:t.offsetY},r&&0!=n.x){if(!x(Math.sign(n.x)*d.rotationSpeed,"y"))return;i.rotation.y+=Math.sign(n.x)*d.rotationSpeed,e=f}if(u&&0!=n.y){if(!x(Math.sign(n.y)*d.rotationSpeed,"x"))return;i.rotation.x+=Math.sign(n.y)*d.rotationSpeed,e=f}}}),!1),n.addEventListener("mouseup",y,!1),n.addEventListener("mouseout",y,!1),n.addEventListener("touchstart",(function(t){t.preventDefault(),e=h,2===t.touches.length||(l={x:t.touches[0].pageX,y:t.touches[0].pageY})}),!1),n.addEventListener("touchmove",(function(t){if(t.preventDefault(),e=f,0===c.length){const n={x:t.touches[0].pageX-l.x,y:t.touches[0].pageY-l.y};if(l={x:t.touches[0].pageX,y:t.touches[0].pageY},r&&0!=n.x){if(!x(Math.sign(n.x)*a,"y"))return;i.rotation.y+=Math.sign(n.x)*a}if(u&&0!=n.y){if(!x(Math.sign(n.y)*a,"x"))return;i.rotation.x+=Math.sign(n.y)*a}}}),!1),n.addEventListener("touchend",(function(t){c.length>0?c.pop():c=[],t.preventDefault(),g()}),!1))};